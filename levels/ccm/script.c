#include <ultra64.h>
#include "sm64.h"
#include "behavior_data.h"
#include "model_ids.h"
#include "seq_ids.h"
#include "dialog_ids.h"
#include "segment_symbols.h"
#include "level_commands.h"

#include "game/level_update.h"

#include "levels/scripts.h"

#include "actors/common1.h"

#include "make_const_nonconst.h"
#include "levels/ccm/header.h"

const LevelScript level_ccm_entry[] = {
	INIT_LEVEL(),
	LOAD_MIO0(0x07, _ccm_segment_7SegmentRomStart, _ccm_segment_7SegmentRomEnd), 
	LOAD_MIO0_TEXTURE(0x09, _snow_mio0SegmentRomStart, _snow_mio0SegmentRomEnd), 
	LOAD_MIO0(0x0B, _effect_mio0SegmentRomStart, _effect_mio0SegmentRomEnd), 
	LOAD_MIO0(0x0A, _bitfs_skybox_mio0SegmentRomStart, _bitfs_skybox_mio0SegmentRomEnd), 
	LOAD_MIO0(0x05, _group2_mio0SegmentRomStart, _group2_mio0SegmentRomEnd), 
	LOAD_RAW(0x0C, _group2_geoSegmentRomStart, _group2_geoSegmentRomEnd), 
	LOAD_MIO0(0x06, _group17_mio0SegmentRomStart, _group17_mio0SegmentRomEnd), 
	LOAD_RAW(0x0D, _group17_geoSegmentRomStart, _group17_geoSegmentRomEnd), 
	LOAD_MIO0(0x08, _common0_mio0SegmentRomStart, _common0_mio0SegmentRomEnd), 
	LOAD_RAW(0x0F, _common0_geoSegmentRomStart, _common0_geoSegmentRomEnd), 
	ALLOC_LEVEL_POOL(),
	MARIO(MODEL_MARIO, 0x00000001, bhvMario), 
	JUMP_LINK(script_func_global_1), 
	JUMP_LINK(script_func_global_3), 
	JUMP_LINK(script_func_global_18), 
	LOAD_MODEL_FROM_GEO(0x3f, sinkinlava_geo), 
	LOAD_MODEL_FROM_GEO(0x41, tiltpyramid_geo), 
	LOAD_MODEL_FROM_GEO(0x37, sinkblock_geo), 
	LOAD_MODEL_FROM_GEO(0x3E, hexring_geo), 
	LOAD_MODEL_FROM_GEO(0x3A, firehat_geo), 

	AREA(1, ccm_area_1),
		WARP_NODE(0x0A, LEVEL_BOB, 0x01, 0x0A, WARP_NO_CHECKPOINT),
		WARP_NODE(0xf0, LEVEL_CASTLE, 0x01, 0xD4, WARP_NO_CHECKPOINT),
		WARP_NODE(0xF1, LEVEL_CASTLE, 0x01, 0xe4, WARP_NO_CHECKPOINT),
		WARP_NODE(0x0B, LEVEL_CCM, 0x02, 0x0A, WARP_NO_CHECKPOINT),
		WARP_NODE(0x0C, LEVEL_BOB, 0x01, 0x0A, WARP_NO_CHECKPOINT),
		OBJECT(MODEL_NONE, 8121, 862, 6008, 0, -155, 0, 0x000A0000, bhvSpinAirborneWarp),
		OBJECT(MODEL_STAR, -2782, -121, -14183, 0, -155, 0, 0x05000000, bhvStar),
		OBJECT(MODEL_BULLY, -3313, -313, -13501, 0, -103, 0, 0x05000000, bhvSmallBully),
		OBJECT(MODEL_BULLY, -2415, -313, -13524, 0, 128, 0, 0x05000000, bhvSmallBully),
		OBJECT(0, 3814, -303, 1897, 0, 37, 0, 0x00000000, bhvCoinFormation),
		OBJECT(0x3F, 3814, -503, 1897, 0, 37, 0, 0x00000000, bhvLllSinkingSquarePlatforms),
		OBJECT(0x41, 2005, -653, 3083, 0, 26, 0, 0x00000000, bhvLllTiltingInvertedPyramid),
		OBJECT(MODEL_RED_FLAME, 8800, 194, 5645, 0, 37, 0, 0x00000000, bhvFlame),
		OBJECT(MODEL_RED_FLAME, 7544, 194, 6322, 0, 37, 0, 0x00000000, bhvFlame),
		OBJECT(MODEL_RED_FLAME, 5003, 72, 4124, 0, 37, 0, 0x00000000, bhvFlame),
		OBJECT(MODEL_RED_FLAME, 3127, 178, 5185, 0, 37, 0, 0x00000000, bhvFlame),
		OBJECT(MODEL_RED_FLAME, 7976, 194, 855, 0, 37, 0, 0x00000000, bhvFlame),
		OBJECT(MODEL_RED_FLAME, 5563, 51, 263, 0, 37, 0, 0x00000000, bhvFlame),
		OBJECT(MODEL_RED_FLAME, -1394, -537, 6511, 0, 37, 0, 0x00000000, bhvFlame),
		OBJECT(MODEL_RED_FLAME, -3895, -537, 6750, 0, 37, 0, 0x00000000, bhvFlame),
		OBJECT(MODEL_RED_FLAME, -5281, -537, 4568, 0, 37, 0, 0x00000000, bhvFlame),
		OBJECT(MODEL_RED_FLAME, -4352, -537, 2697, 0, 37, 0, 0x00000000, bhvFlame),
		OBJECT(MODEL_RED_FLAME, 474, 280, 445, 0, 37, 0, 0x00000000, bhvFlame),
		OBJECT(MODEL_RED_FLAME, 2866, 300, -204, 0, 37, 0, 0x00000000, bhvFlame),
		OBJECT(MODEL_RED_FLAME, 1808, -50, 1996, 0, 37, 0, 0x00000000, bhvFlame),
		OBJECT(MODEL_SNUFIT, 583, -1, 984, 0, 37, 0, 0x00000000, bhvSnufit),
		OBJECT(0xD7, 6879, -353, 497, 0, 37, 0, 0x00000000, bhvRedCoin),
		OBJECT(0x37, 6879, -503, 497, 0, 37, 0, 0x00000000, bhvLllSinkingRockBlock),
		OBJECT(0x3F, 8103, -503, 3662, 0, 3, 0, 0x00000000, bhvLllSinkingSquarePlatforms),
		OBJECT(0x57, -2746, 966, 4462, 0, 3, 0, 0x00000000, bhvBigBullyWithMinions),
		OBJECT(0, 8105, -303, 3663, 0, 3, 0, 0x00000000, bhvCoinFormation),
		OBJECT(MODEL_BULLY, 2393, 334, -949, 0, 6, 0, 0x05000000, bhvSmallBully),
		OBJECT(MODEL_BULLY, 2841, -154, 4407, 0, 51, 0, 0x05000000, bhvSmallBully),
		OBJECT(MODEL_STAR, 3568, 2262, -3506, 0, -155, 0, 0x01000000, bhvStar),
		OBJECT(0x41, 6287, -653, 2384, 0, 26, 0, 0x00000000, bhvLllTiltingInvertedPyramid),
		OBJECT(0x3E, 3849, -138, -3362, 0, 37, 0, 0x00000000, bhvLllRotatingHexagonalRing),
		OBJECT(0x3A, 3568, 1447, -3506, 0, -155, 0, 0x00000000, bhvLllRotatingBlockWithFireBars),
		OBJECT(0x3A, 3568, 1652, -3506, 0, -155, 0, 0x00000000, bhvLllRotatingBlockWithFireBars),
		OBJECT(0x3A, 3568, 1857, -3506, 0, -155, 0, 0x00000000, bhvLllRotatingBlockWithFireBars),
		OBJECT(MODEL_WOODEN_SIGNPOST, 8430, -138, 1161, 0, -57, 0, 0x00000000, bhvMessagePanel),
		OBJECT_WITH_ACTS(0x89, 8067, 162, 1463, 0, -57, 0, 0x00030000, bhvExclamationBox, ACT_6),
		OBJECT(0x37, 4203, -482, 136, 0, 104, 0, 0x00000000, bhvLllSinkingRockBlock),
		OBJECT(0xd7, 4203, -332, 136, 0, 104, 0, 0x00000000, bhvRedCoin),
		OBJECT(0, 5606, -256, -398, 0, 104, 0, 0x00000000, bhvMrI),
		OBJECT(0, 5606, -255, -412, 0, 37, 0, 0x00020000, bhvCoinFormation),
		OBJECT(0, 458, -431, 3609, 0, 97, 0, 0x00000000, bhvCoinFormation),
		OBJECT(0, 2494, 168, 308, 0, 37, 0, 0x03000000, bhvHiddenRedCoinStar),
		OBJECT(0xD7, 5858, -352, 5245, 0, 63, 0, 0x00000000, bhvRedCoin),
		OBJECT(0x37, 5858, -502, 5245, 0, 63, 0, 0x00000000, bhvLllSinkingRockBlock),
		OBJECT(0, -1925, 151, -3774, 0, 37, 0, 0x00040000, bhvHiddenStarTrigger),
		OBJECT(0, -846, 151, -3595, 0, 37, 0, 0x00040000, bhvFlamethrower),
		OBJECT(MODEL_YELLOW_COIN, -846, 151, -3595, 0, 37, 0, 0x00040000, bhvYellowCoin),
		OBJECT(0, -1925, 151, -3774, 0, 37, 0, 0x00040000, bhvFlamethrower),
		OBJECT(0, -846, 151, -3595, 0, 37, 0, 0x00040000, bhvHiddenStarTrigger),
		OBJECT(0, -837, 151, -4757, 0, 37, 0, 0x00040000, bhvFlamethrower),
		OBJECT(MODEL_YELLOW_COIN, -837, 151, -4757, 0, 37, 0, 0x00040000, bhvYellowCoin),
		OBJECT(0, -837, 151, -4757, 0, 37, 0, 0x00040000, bhvHiddenStarTrigger),
		OBJECT(MODEL_YELLOW_COIN, -1925, 151, -3774, 0, 37, 0, 0x00040000, bhvYellowCoin),
		OBJECT(0, 188, 151, -5269, 0, 37, 0, 0x00040000, bhvFlamethrower),
		OBJECT(MODEL_YELLOW_COIN, 188, 151, -5269, 0, 37, 0, 0x00040000, bhvYellowCoin),
		OBJECT(0, 188, 151, -5269, 0, 37, 0, 0x00040000, bhvHiddenStarTrigger),
		OBJECT(0, -1746, 151, -5111, 0, 37, 0, 0x00040000, bhvFlamethrower),
		OBJECT(MODEL_YELLOW_COIN, -1746, 151, -5111, 0, 37, 0, 0x00040000, bhvYellowCoin),
		OBJECT(0, -1746, 151, -5111, 0, 37, 0, 0x00040000, bhvHiddenStarTrigger),
		OBJECT(0, -2615, 2104, -4356, 0, 37, 0, 0x04000000, bhvHiddenStar),
		OBJECT(0x41, 1119, -138, -2176, 0, 26, 0, 0x00000000, bhvLllTiltingInvertedPyramid),
		OBJECT(0x41, 697, -103, -3303, 0, 26, 0, 0x00000000, bhvLllTiltingInvertedPyramid),
		OBJECT(0x89, 504, 485, -4328, 0, -57, 0, 0x00050000, bhvExclamationBox),
		OBJECT(0xD7, 923, -472, 5130, 0, 0, 0, 0x00000000, bhvRedCoin),
		OBJECT(0x37, 923, -622, 5130, 0, 0, 0, 0x00000000, bhvLllSinkingRockBlock),
		OBJECT(0xD7, -527, -518, 1911, 0, 44, 0, 0x00000000, bhvRedCoin),
		OBJECT(0x37, -527, -668, 1911, 0, 44, 0, 0x00000000, bhvLllSinkingRockBlock),
		OBJECT(0xD7, 9607, -348, 1894, 0, -16, 0, 0x00000000, bhvRedCoin),
		OBJECT(0x37, 9607, -498, 1894, 0, -16, 0, 0x00000000, bhvLllSinkingRockBlock),
		OBJECT(0xD7, 1838, 18, -4694, 0, -65, 0, 0x00000000, bhvRedCoin),
		OBJECT(0x37, 1838, -132, -4694, 0, -65, 0, 0x00000000, bhvLllSinkingRockBlock),
		OBJECT(0xD7, 6164, 16, -3569, 0, -81, 0, 0x00000000, bhvRedCoin),
		OBJECT(0x37, 6164, -134, -3569, 0, -81, 0, 0x00000000, bhvLllSinkingRockBlock),
		OBJECT(MODEL_SNUFIT, 7538, -38, 1741, 0, 37, 0, 0x00000000, bhvSnufit),
		OBJECT(MODEL_SNUFIT, 4862, -232, 3327, 0, 127, 0, 0x00000000, bhvSnufit),
		OBJECT(0x89, 900, 634, -596, 0, -57, 0, 0x00060000, bhvExclamationBox),
		OBJECT(0, -2787, -739, 1433, 0, 104, 0, 0x00000000, bhvMrI),
		OBJECT(MODEL_YELLOW_COIN, -3953, -625, 3786, 0, 37, 0, 0x00040000, bhvYellowCoin),
		OBJECT(MODEL_YELLOW_COIN, -2838, -625, 3076, 0, 37, 0, 0x00040000, bhvYellowCoin),
		OBJECT(MODEL_YELLOW_COIN, -1568, -625, 3832, 0, 37, 0, 0x00040000, bhvYellowCoin),
		OBJECT(MODEL_YELLOW_COIN, -1703, -625, 5154, 0, 37, 0, 0x00040000, bhvYellowCoin),
		OBJECT(MODEL_YELLOW_COIN, -2831, -625, 5742, 0, 37, 0, 0x00040000, bhvYellowCoin),
		OBJECT(MODEL_YELLOW_COIN, -3988, -625, 4998, 0, 37, 0, 0x00040000, bhvYellowCoin),
		OBJECT(0x89, 4184, 146, 4960, 0, -57, 0, 0x00060000, bhvExclamationBox),
		OBJECT(MODEL_SNUFIT, 4194, 682, -3872, 0, 37, 0, 0x00000000, bhvSnufit),
		OBJECT(0, -2802, -739, 1417, 0, 37, 0, 0x00020000, bhvCoinFormation),
		OBJECT(0, -3163, -739, 502, 0, 22, 0, 0x280b0000, bhvWarp),
		OBJECT(0, -2950, -739, 1044, 0, 22, 0, 0x000C0000, bhvInstantActiveWarp),
		TERRAIN(ccm_area_1_collision),
		MACRO_OBJECTS(ccm_area_1_macro_objs),
		SET_BACKGROUND_MUSIC(0x00, 0x28),
		TERRAIN_TYPE(TERRAIN_STONE),
	END_AREA(),

	AREA(2, ccm_area_2),
		WARP_NODE(0x0A, LEVEL_BOB, 0x01, 0x0A, WARP_NO_CHECKPOINT),
		WARP_NODE(0xf0, LEVEL_CASTLE, 0x01, 0xD4, WARP_NO_CHECKPOINT),
		WARP_NODE(0xF1, LEVEL_CASTLE, 0x01, 0xe4, WARP_NO_CHECKPOINT),
		WARP_NODE(0x0B, LEVEL_CCM, 0x01, 0x0C, WARP_NO_CHECKPOINT),
		WARP_NODE(0x0C, LEVEL_BOB, 0x01, 0x0A, WARP_NO_CHECKPOINT),
		OBJECT(0, -822, -183, -1969, 0, 25, 0, 0x000A0000, bhvInstantActiveWarp),
		OBJECT(MODEL_BLUE_COIN, -709, -262, -227, 0, 140, 0, 0x00000000, bhvHiddenBlueCoin),
		OBJECT(0x8C, -2167, 517, -1197, 0, 140, 0, 0x00000000, bhvBlueCoinSwitch),
		OBJECT(MODEL_BLUE_COIN, 297, -262, -589, 0, 140, 0, 0x00000000, bhvHiddenBlueCoin),
		OBJECT(MODEL_BLUE_COIN, 634, -262, 257, 0, 140, 0, 0x00000000, bhvHiddenBlueCoin),
		OBJECT(MODEL_BLUE_COIN, -409, -262, 591, 0, 140, 0, 0x00000000, bhvHiddenBlueCoin),
		OBJECT(0x89, 655, 817, -2304, 0, -57, 0, 0x00020000, bhvExclamationBox),
		OBJECT(0xC9, 920, 137, 2596, 0, 112, 0, 0x00500000, bhvCannonClosed),
		OBJECT(0xC3, -11, 0, -9, 0, 22, 0, 0x00000000, bhvBobombBuddyOpensCannon),
		OBJECT(MODEL_STAR, -960, 1762, -2329, 0, -155, 0, 0x02000000, bhvStar),
		OBJECT(0, 503, -183, 1196, 0, -67, 0, 0x00000000, bhvCoinFormation),
		OBJECT(0, -1033, -183, -2489, 0, 22, 0, 0x280b0000, bhvWarp),
		TERRAIN(ccm_area_2_collision),
		MACRO_OBJECTS(ccm_area_2_macro_objs),
		SET_BACKGROUND_MUSIC(0x00, 0x28),
		TERRAIN_TYPE(TERRAIN_STONE),
	END_AREA(),

	FREE_LEVEL_POOL(),
	MARIO_POS(1, 0, 0, 0, 0),
	CALL(0, lvl_init_or_update),
	CALL_LOOP(1, lvl_init_or_update),
	CLEAR_LEVEL(),
	SLEEP_BEFORE_EXIT(1),
	EXIT(),
};
