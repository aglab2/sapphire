#include <ultra64.h>
#include "sm64.h"
#include "behavior_data.h"
#include "model_ids.h"
#include "seq_ids.h"
#include "dialog_ids.h"
#include "segment_symbols.h"
#include "level_commands.h"

#include "game/level_update.h"

#include "levels/scripts.h"

#include "actors/common1.h"

#include "make_const_nonconst.h"
#include "levels/bob/header.h"

const LevelScript level_bob_entry[] = {
	INIT_LEVEL(),
	LOAD_MIO0(0x07, _bob_segment_7SegmentRomStart, _bob_segment_7SegmentRomEnd), 
	LOAD_MIO0_TEXTURE(0x09, _generic_mio0SegmentRomStart, _generic_mio0SegmentRomEnd), 
	LOAD_MIO0(0x0A, _cloud_floor_skybox_mio0SegmentRomStart, _cloud_floor_skybox_mio0SegmentRomEnd), 
	LOAD_MIO0(0x06, _group14_mio0SegmentRomStart, _group14_mio0SegmentRomEnd), 
	LOAD_RAW(0x0D, _group14_geoSegmentRomStart, _group14_geoSegmentRomEnd), 
	LOAD_MIO0(0x05, _group1_mio0SegmentRomStart, _group1_mio0SegmentRomEnd), 
	LOAD_RAW(0x0C, _group1_geoSegmentRomStart, _group1_geoSegmentRomEnd), 
	LOAD_MIO0(0x08, _common0_mio0SegmentRomStart, _common0_mio0SegmentRomEnd), 
	LOAD_RAW(0x0F, _common0_geoSegmentRomStart, _common0_geoSegmentRomEnd), 
	ALLOC_LEVEL_POOL(),
	MARIO(MODEL_MARIO, 0x00000001, bhvMario), 
	JUMP_LINK(script_func_global_1), 
	JUMP_LINK(script_func_global_2), 
	JUMP_LINK(script_func_global_15), 
	LOAD_MODEL_FROM_GEO(MODEL_BOB_BUBBLY_TREE, bubbly_tree_geo), 
	LOAD_MODEL_FROM_GEO(MODEL_BOB_BARS_GRILLS, bob_geo_000470), 

	AREA(1, bob_area_1),
		WARP_NODE(0xF0, LEVEL_CASTLE, 0x01, 0xD1, WARP_NO_CHECKPOINT),
		WARP_NODE(0xF1, LEVEL_CASTLE, 0x01, 0xE1, WARP_NO_CHECKPOINT),
		WARP_NODE(0x0A, LEVEL_BOB, 0x01, 0x0A, WARP_NO_CHECKPOINT),
		WARP_NODE(0x1C, LEVEL_BOB, 0x02, 0x0A, WARP_NO_CHECKPOINT),
		WARP_NODE(0x0C, LEVEL_BOB, 0x01, 0x0A, WARP_NO_CHECKPOINT),
		OBJECT(0, -4831, 503, 3480, 0, 139, 0, 0x000A0000, bhvSpinAirborneWarp),
		OBJECT(MODEL_BOB_BUBBLY_TREE, -3346, -949, 4208, 0, 139, 0, 0x000A0000, bhvTree),
		OBJECT(MODEL_BOB_BUBBLY_TREE, -4934, -949, 454, 0, 139, 0, 0x000A0000, bhvTree),
		OBJECT(0, -1434, -534, 2126, 0, 167, 0, 0x0000, bhvCoinFormation),
		OBJECT(0, 1465, -473, -1654, 0, 167, 0, 0x00020000, bhvCoinFormation),
		OBJECT(0, -1854, -356, 194, 0, -146, 0, 0, bhvCoinFormation),
		OBJECT(0, -3829, -229, -1199, 0, -110, 0, 0, bhvCoinFormation),
		OBJECT(MODEL_BOB_BUBBLY_TREE, -1879, -949, 1456, 0, 139, 0, 0, bhvTree),
		OBJECT(0, 3795, -881, -391, 0, 167, 0, 0x00020000, bhvCoinFormation),
		OBJECT(0, 1465, -273, -1654, 0, 167, 0, 0x03000000, bhvHiddenRedCoinStar),
		OBJECT(0x89, 3286, 1149, -3123, 0, 167, 0, 0x00000000, bhvExclamationBox),
		OBJECT(0x89, -698, -924, 4160, 0, 167, 0, 0x00060000, bhvExclamationBox),
		OBJECT(0, -495, -949, -705, 0, -134, 0, 0, bhvCoinFormation),
		OBJECT(0, 1688, -1224, 2288, 0, 169, 0, 0, bhvCoinFormation),
		OBJECT(0, -3348, -949, 4214, 0, 167, 0, 0x00020000, bhvCoinFormation),
		OBJECT(0, 3293, 356, -3129, 0, 167, 0, 0x00020000, bhvCoinFormation),
		OBJECT(MODEL_BOB_BUBBLY_TREE, 3875, -1224, 2789, 0, 139, 0, 0x000A0000, bhvTree),
		OBJECT(MODEL_BOB_BUBBLY_TREE, 3194, -1224, 4597, 0, 139, 0, 0x000A0000, bhvTree),
		OBJECT(MODEL_BOB_BUBBLY_TREE, -3813, -675, -4952, 0, 139, 0, 0x000A0000, bhvTree),
		OBJECT(MODEL_BOB_BUBBLY_TREE, 42, -949, -1213, 0, 139, 0, 0x000A0000, bhvTree),
		OBJECT(MODEL_BOB_BUBBLY_TREE, 2311, -1224, 177, 0, 139, 0, 0x000A0000, bhvTree),
		OBJECT(MODEL_BOB_BUBBLY_TREE, -234, -1224, 5108, 0, 139, 0, 0x000A0000, bhvTree),
		OBJECT(MODEL_BOB_BUBBLY_TREE, 4854, -881, -24, 0, 139, 0, 0x000A0000, bhvTree),
		OBJECT(MODEL_BOB_BUBBLY_TREE, 2022, -538, -2165, 0, 139, 0, 0x000A0000, bhvTree),
		OBJECT(MODEL_BOB_BUBBLY_TREE, -1408, -675, -4860, 0, 139, 0, 0x000A0000, bhvTree),
		OBJECT(MODEL_BOB_BUBBLY_TREE, 3622, -1171, 4006, 0, 139, 0, 0x000A0000, bhvTree),
		OBJECT(0x64, 3800, -881, -384, 0, 167, 0, 0x0000, bhvPiranhaPlant),
		OBJECT(0x64, -3022, -1018, 1728, 0, 167, 0, 0x0000, bhvPiranhaPlant),
		OBJECT(0x64, -3628, -1018, 791, 0, 167, 0, 0x0000, bhvPiranhaPlant),
		OBJECT(0x64, 491, -1224, 5140, 0, 167, 0, 0x0000, bhvPiranhaPlant),
		OBJECT(0x64, -1766, -538, 3585, 0, 167, 0, 0x00010000, bhvFirePiranhaPlant),
		OBJECT(0x64, -1203, -332, 1099, 0, 167, 0, 0x00010000, bhvFirePiranhaPlant),
		OBJECT(0x64, -2531, -126, -774, 0, 167, 0, 0x00010000, bhvFirePiranhaPlant),
		OBJECT(0x64, -5514, -126, -1711, 0, 167, 0, 0x00010000, bhvFirePiranhaPlant),
		OBJECT(0x64, -6143, -538, -112, 0, 167, 0, 0x00010000, bhvFirePiranhaPlant),
		OBJECT(MODEL_CHAIN_CHOMP, -2641, -675, -4342, 0, 167, 0, 0x00000000, bhvChainChomp),
		OBJECT(MODEL_STAR, 3404, 2114, 3513, 0, 167, 0, 0x02000000, bhvStar),
		OBJECT(MODEL_BREAKABLE_BOX, 2622, 883, 4554, 0, 167, 0, 0x02000000, bhvJumpingBox),
		OBJECT(MODEL_GOOMBA, -1743, -949, -1549, 0, 167, 0, 0x00010000, bhvGoomba),
		OBJECT(MODEL_GOOMBA, 83, -1026, 343, 0, 167, 0, 0x00010000, bhvGoomba),
		OBJECT(0xD7, -2641, -420, -4342, 0, 167, 0, 0x00000000, bhvRedCoin),
		OBJECT(MODEL_GOOMBA, 30, -969, 2215, 0, 167, 0, 0x00010000, bhvGoomba),
		OBJECT(MODEL_STAR, -2786, -475, -6158, 0, 167, 0, 0x01000000, bhvStar),
		OBJECT(0x6B, 1604, -538, -3714, 0, 167, 0, 0x00020000, bhvWoodenPost),
		OBJECT(0x6B, 4059, -538, -1820, 0, 167, 0, 0x00020000, bhvWoodenPost),
		OBJECT(0x6B, -5227, -675, -2956, 0, 167, 0, 0x00020000, bhvWoodenPost),
		OBJECT(0x6B, 4649, -881, 1044, 0, 167, 0, 0x00020000, bhvWoodenPost),
		OBJECT(0x6B, 2099, -1224, 3485, 0, 167, 0, 0x00020000, bhvWoodenPost),
		OBJECT(0x6B, -1064, -949, -2249, 0, 167, 0, 0x00020000, bhvWoodenPost),
		OBJECT(0xD7, 2099, -969, 3485, 0, 167, 0, 0x00020000, bhvRedCoin),
		OBJECT(0xD7, -1064, -694, -2249, 0, 167, 0, 0x00020000, bhvRedCoin),
		OBJECT(0x6B, 1653, -1224, 38, 0, 167, 0, 0x00020000, bhvWoodenPost),
		OBJECT(0x6B, 2951, 356, -2866, 0, 167, 0, 0x00020000, bhvWoodenPost),
		OBJECT(0xD7, 1604, -283, -3714, 0, 167, 0, 0x00020000, bhvRedCoin),
		OBJECT(0xD7, 4649, -626, 1044, 0, 167, 0, 0x00020000, bhvRedCoin),
		OBJECT(0xD7, -5227, -420, -2956, 0, 167, 0, 0x00020000, bhvRedCoin),
		OBJECT(0xD7, 4059, -283, -1820, 0, 167, 0, 0x00020000, bhvRedCoin),
		OBJECT(0xD7, 1653, -969, 38, 0, 167, 0, 0x00020000, bhvRedCoin),
		OBJECT(0, -2760, -675, -5739, 0, 5, 0, 0, bhvOpenableGrill),
		OBJECT(0xCF, -1476, 977, -5300, 0, -30, 0, 0, bhvFloorSwitchGrills),
		OBJECT(0, 4447, 356, -4289, 0, 167, 0, 0x201C0000, bhvWarp),
		OBJECT(0, 4007, 356, -3859, 0, -46, 0, 0x000C0000, bhvInstantActiveWarp),
		OBJECT(MODEL_YELLOW_COIN, -258, 1680, 201, 0, 167, 0, 0x00020000, bhvYellowCoin),
		OBJECT(MODEL_YELLOW_COIN, 149, 2714, 2879, 0, 167, 0, 0x00020000, bhvYellowCoin),
		OBJECT(MODEL_YELLOW_COIN, 2227, 2204, 296, 0, 167, 0, 0x00020000, bhvYellowCoin),
		OBJECT(MODEL_YELLOW_COIN, -510, 1944, -1967, 0, 167, 0, 0x00020000, bhvYellowCoin),
		OBJECT(MODEL_YELLOW_COIN, -2904, 2487, 79, 0, 167, 0, 0x00020000, bhvYellowCoin),
		OBJECT(0, -258, 1880, 201, 0, 167, 0, 0x05000000, bhvHiddenStar),
		OBJECT(0, -258, 1680, 201, 0, 167, 0, 0x00020000, bhvHiddenStarTrigger),
		OBJECT(0, 149, 2714, 2879, 0, 167, 0, 0x00020000, bhvHiddenStarTrigger),
		OBJECT(0, 2227, 2204, 296, 0, 167, 0, 0x00020000, bhvHiddenStarTrigger),
		OBJECT(0, -510, 1944, -1967, 0, 167, 0, 0x00020000, bhvHiddenStarTrigger),
		OBJECT(0, -2904, 2487, 79, 0, 167, 0, 0x00020000, bhvHiddenStarTrigger),
		TERRAIN(bob_area_1_collision),
		MACRO_OBJECTS(bob_area_1_macro_objs),
		SET_BACKGROUND_MUSIC(0x00, 0x25),
		TERRAIN_TYPE(TERRAIN_GRASS),
	END_AREA(),

	AREA(2, bob_area_2),
		WARP_NODE(0x11, LEVEL_BOB, 0x01, 0x0A, WARP_NO_CHECKPOINT),
		WARP_NODE(0xF0, LEVEL_CASTLE, 0x01, 0xD1, WARP_NO_CHECKPOINT),
		WARP_NODE(0xF1, LEVEL_CASTLE, 0x01, 0xE1, WARP_NO_CHECKPOINT),
		WARP_NODE(0x0A, LEVEL_BOB, 0x01, 0x0A, WARP_NO_CHECKPOINT),
		WARP_NODE(0x0B, LEVEL_BOB, 0x01, 0x0C, WARP_NO_CHECKPOINT),
		OBJECT(0xFF, 532, -2861, 148, 0, 30, 0, 0x00000000, bhvWaddleGuy),
		OBJECT(0xFF, -414, -2861, -482, 0, -96, 0, 0x00000000, bhvWaddleGuy),
		OBJECT(0xFF, -397, -2861, 610, 0, 167, 0, 0x00000000, bhvWaddleGuy),
		OBJECT(0x58, -1491, -2861, 755, 0, 135, 0, 0x00000000, bhvThwomp),
		OBJECT(0x58, -948, -1558, 1352, 0, 135, 0, 0x00000000, bhvThwomp),
		OBJECT(0x58, -1512, -255, 767, 0, 135, 0, 0x00000000, bhvThwomp),
		OBJECT(0, 5, 1527, -24, 0, 135, 0, 0x00FF0000, bhvPoleGrabbing),
		OBJECT(MODEL_STAR, 850, 1547, -899, 0, 167, 0, 0x04000000, bhvStar),
		OBJECT(0, 836, -2861, -869, 0, -46, 0, 0x000A0000, bhvInstantActiveWarp),
		OBJECT(0, 1238, -2861, -1287, 0, 167, 0, 0x000B0000, bhvWarp),
		TERRAIN(bob_area_2_collision),
		MACRO_OBJECTS(bob_area_2_macro_objs),
		SET_BACKGROUND_MUSIC(0x00, SEQ_LEVEL_UNDERGROUND),
		TERRAIN_TYPE(TERRAIN_GRASS),
	END_AREA(),

	FREE_LEVEL_POOL(),
	MARIO_POS(1, 0, 0, 0, 0),
	CALL(0, lvl_init_or_update),
	CALL_LOOP(1, lvl_init_or_update),
	CLEAR_LEVEL(),
	SLEEP_BEFORE_EXIT(1),
	EXIT(),
};
